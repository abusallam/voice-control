#!/bin/bash
# Voice Control UI Launcher
# Launches the system tray application for easy voice control access.

# Set up Python path to include the voice control modules
INSTALL_DIR="$HOME/.local/share/voice-control"
export PYTHONPATH="$INSTALL_DIR:$PYTHONPATH"

# Use system Python to avoid virtual environment issues
PYTHON_CMD="/usr/bin/python3"

# Check if system Python is available
if [ ! -x "$PYTHON_CMD" ]; then
    PYTHON_CMD="python3"
fi

# Change to the application directory
cd "$INSTALL_DIR" 2>/dev/null || {
    echo "Error: Voice Control not properly installed"
    echo "Please run: ./install.sh"
    exit 1
}

# Run the system tray application
exec $PYTHON_CMD -c "
import sys
sys.path.insert(0, '$INSTALL_DIR')
try:
    from voice_control.gui.system_tray import main
    sys.exit(main())
except ImportError as e:
    print(f'Error: Failed to import system tray application: {e}')
    print('Please ensure PyQt5 is installed: sudo apt install python3-pyqt5')
    print('If the issue persists, try reinstalling: ./install.sh')
    sys.exit(1)
except Exception as e:
    print(f'Error: Failed to start voice control UI: {e}')
    sys.exit(1)
"